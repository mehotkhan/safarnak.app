type Query {
  getMessages: [Message!]!
  me: User
  getTrips(status: String): [Trip!]!
  getTrip(id: ID!): Trip
  getTours(category: String, limit: Int): [Tour!]!
  getTour(id: ID!): Tour
  getPlaces(category: String, limit: Int): [Place!]!
  getPlace(id: ID!): Place
  getAlerts: [Alert!]!
  checkUsernameAvailability(username: String!): Boolean!
  getMyDevices: [Device!]!
}

type Mutation {
  addMessage(content: String!): Message!
  requestChallenge(username: String!, isRegister: Boolean!): String!
  registerUser(username: String!, publicKey: String!, signature: String!, deviceId: String!): AuthPayload!
  loginUser(username: String!, signature: String!, deviceId: String!, publicKey: String): AuthPayload!
  createTrip(input: CreateTripInput!): Trip!
  updateTrip(id: ID!, input: UpdateTripInput!): Trip!
  deleteTrip(id: ID!): Boolean!
  bookmarkTour(tourId: ID!): Boolean!
  bookmarkPlace(placeId: ID!): Boolean!
  revokeDevice(deviceId: String!): Boolean!
}

type Subscription {
  newMessages: Message!
  newAlerts: Alert!
  tripUpdates(tripId: ID!): TripUpdate!
}

type Message {
  id: ID!
  content: String!
  createdAt: String!
}

type User {
  id: ID!
  name: String!
  username: String!
  publicKey: String
  createdAt: String!
}

type AuthPayload {
  user: User!
  token: String!
}

type Trip {
  id: ID!
  userId: ID!
  destination: String
  startDate: String
  endDate: String
  budget: Float
  travelers: Int!
  preferences: String
  accommodation: String
  status: String!
  aiReasoning: String
  itinerary: [ItineraryDay!]
  coordinates: Coordinates
  waypoints: [Waypoint!]
  createdAt: String!
  updatedAt: String!
}

type ItineraryDay {
  day: Int!
  title: String!
  activities: [String!]!
}

type Coordinates {
  latitude: Float!
  longitude: Float!
}

type Waypoint {
  latitude: Float!
  longitude: Float!
  label: String
}

input CreateTripInput {
  destination: String
  startDate: String
  endDate: String
  budget: Float
  travelers: Int!
  preferences: String
  accommodation: String
}

input UpdateTripInput {
  destination: String
  startDate: String
  endDate: String
  budget: Float
  travelers: Int
  preferences: String
  accommodation: String
  status: String
  aiReasoning: String
  itinerary: String
  userMessage: String
}

type Tour {
  id: ID!
  title: String!
  location: String!
  price: Float!
  rating: Float!
  reviews: Int!
  duration: Int!
  category: String!
  description: String!
  highlights: [String!]!
  inclusions: [String!]!
  maxParticipants: Int!
  difficulty: String!
  createdAt: String!
}

type Place {
  id: ID!
  name: String!
  location: String!
  distance: Float
  rating: Float!
  reviews: Int!
  category: String!
  isOpen: Boolean!
  description: String!
  tips: [String!]!
  coordinates: Coordinates!
  phone: String
  website: String
  hours: String
  createdAt: String!
}

type Alert {
  id: ID!
  type: String!
  title: String!
  message: String!
  step: Int
  totalSteps: Int
  tripId: ID
  userId: ID!
  read: Boolean
  createdAt: String!
}

type TripUpdate {
  id: ID!
  tripId: ID!
  type: String!
  title: String!
  message: String!
  step: Int!
  totalSteps: Int!
  status: String!
  data: String
  createdAt: String!
}

type Device {
  id: ID!
  deviceId: String!
  publicKey: String!
  type: String
  lastSeen: String!
  createdAt: String!
}
