type Query {
  getMessages: [Message!]!
  me: User
  getUser(id: ID!): User
  getTrips(status: String): [Trip!]!
  getTrip(id: ID!): Trip
  getTours(category: String, limit: Int): [Tour!]!
  getTour(id: ID!): Tour
  getPlaces(category: String, limit: Int): [Place!]!
  getPlace(id: ID!): Place
  getLocations(limit: Int): [Location!]!
  getLocation(id: ID!): Location
  getPosts(type: String, limit: Int, offset: Int, after: String, before: String): PostsConnection!
  getPost(id: ID!): Post
  getBookmarks(type: String): [Bookmark!]!
  getAlerts: [Alert!]!
  checkUsernameAvailability(username: String!): Boolean!
  getMyDevices: [Device!]!
}

type Mutation {
  addMessage(content: String!): Message!
  requestChallenge(username: String!, isRegister: Boolean!): String!
  registerUser(username: String!, publicKey: String!, signature: String!, deviceId: String!): AuthPayload!
  loginUser(username: String!, signature: String!, deviceId: String!, publicKey: String): AuthPayload!
  updateUser(input: UpdateUserInput!): User!
  createTrip(input: CreateTripInput!): Trip!
  updateTrip(id: ID!, input: UpdateTripInput!): Trip!
  deleteTrip(id: ID!): Boolean!
  createTour(input: CreateTourInput!): Tour!
  updateTour(id: ID!, input: UpdateTourInput!): Tour!
  deleteTour(id: ID!): Boolean!
  createPlace(input: CreatePlaceInput!): Place!
  updatePlace(id: ID!, input: UpdatePlaceInput!): Place!
  deletePlace(id: ID!): Boolean!
  createLocation(input: CreateLocationInput!): Location!
  updateLocation(id: ID!, input: UpdateLocationInput!): Location!
  deleteLocation(id: ID!): Boolean!
  bookTour(input: BookTourInput!): Booking!
  createPost(input: CreatePostInput!): Post!
  createComment(postId: ID!, content: String!): Comment!
  createReaction(postId: ID, commentId: ID, emoji: String!): Reaction!
  deleteReaction(reactionId: ID!): Boolean!
  bookmarkPost(postId: ID!): Boolean!
  bookmarkTour(tourId: ID!): Boolean!
  bookmarkPlace(placeId: ID!): Boolean!
  revokeDevice(deviceId: String!): Boolean!
}

type Subscription {
  newMessages: Message!
  newAlerts: Alert!
  tripUpdates(tripId: ID!): TripUpdate!
}

type Message {
  id: ID!
  content: String!
  createdAt: String!
}

type User {
  id: ID!
  name: String!
  username: String!
  email: String
  phone: String
  avatar: String
  publicKey: String
  createdAt: String!
}

type AuthPayload {
  user: User!
  token: String!
}

type Trip {
  id: ID!
  userId: ID!
  destination: String
  startDate: String
  endDate: String
  budget: Float
  travelers: Int!
  preferences: String
  accommodation: String
  status: String!
  aiReasoning: String
  itinerary: [ItineraryDay!]
  coordinates: Coordinates
  waypoints: [Waypoint!]
  createdAt: String!
  updatedAt: String!
}

type ItineraryDay {
  day: Int!
  title: String!
  activities: [String!]!
}

type Coordinates {
  latitude: Float!
  longitude: Float!
}

type Waypoint {
  latitude: Float!
  longitude: Float!
  label: String
}

input CreateTripInput {
  destination: String
  startDate: String
  endDate: String
  budget: Float
  travelers: Int!
  preferences: String
  accommodation: String
}

input UpdateTripInput {
  destination: String
  startDate: String
  endDate: String
  budget: Float
  travelers: Int
  preferences: String
  accommodation: String
  status: String
  aiReasoning: String
  itinerary: String
  userMessage: String
}

type Tour {
  id: ID!
  title: String!
  location: String!
  price: Float!
  rating: Float!
  reviews: Int!
  duration: Int!
  durationType: String!
  category: String!
  description: String
  shortDescription: String
  highlights: [String!]!
  inclusions: [String!]!
  maxParticipants: Int
  minParticipants: Int!
  difficulty: String!
  currency: String!
  coordinates: Coordinates
  imageUrl: String
  gallery: [String!]!
  tags: [String!]!
  isActive: Boolean!
  isFeatured: Boolean!
  createdAt: String!
  updatedAt: String!
}

type Place {
  id: ID!
  name: String!
  location: String!
  distance: Float
  rating: Float!
  reviews: Int!
  type: String!
  isOpen: Boolean!
  description: String!
  tips: [String!]!
  coordinates: Coordinates!
  phone: String
  website: String
  hours: String
  price: Int
  locationId: ID
  ownerId: ID
  imageUrl: String
  createdAt: String!
}

type Location {
  id: ID!
  name: String!
  country: String!
  description: String
  coordinates: Coordinates!
  popularActivities: [String!]!
  averageCost: Float
  bestTimeToVisit: String
  population: String
  createdAt: String!
  updatedAt: String!
}

type Booking {
  id: ID!
  tourId: ID!
  userId: ID!
  participants: Int!
  selectedDate: String!
  fullName: String!
  email: String!
  phone: String
  specialRequests: String
  totalPrice: Float!
  status: String!
  createdAt: String!
}

type Alert {
  id: ID!
  type: String!
  title: String!
  message: String!
  step: Int
  totalSteps: Int
  tripId: ID
  userId: ID!
  read: Boolean
  createdAt: String!
}

type TripUpdate {
  id: ID!
  tripId: ID!
  type: String!
  title: String!
  message: String!
  step: Int!
  totalSteps: Int!
  status: String!
  data: String
  createdAt: String!
}

type Device {
  id: ID!
  deviceId: String!
  publicKey: String!
  type: String
  lastSeen: String!
  createdAt: String!
}

type Post {
  id: ID!
  userId: ID!
  user: User!
  content: String
  attachments: [String!]!
  type: String
  relatedId: ID
  relatedEntity: PostRelatedEntity
  comments: [Comment!]!
  commentsCount: Int!
  reactions: [Reaction!]!
  reactionsCount: Int!
  isBookmarked: Boolean!
  createdAt: String!
}

union PostRelatedEntity = Trip | Tour | Place

type Comment {
  id: ID!
  postId: ID!
  userId: ID!
  user: User!
  content: String!
  createdAt: String!
}

type Reaction {
  id: ID!
  postId: ID
  commentId: ID
  userId: ID!
  user: User!
  emoji: String!
  createdAt: String!
}

type Bookmark {
  id: ID!
  userId: ID!
  postId: ID
  tourId: ID
  placeId: ID
  post: Post
  tour: Tour
  place: Place
  createdAt: String!
}

type PostsConnection {
  posts: [Post!]!
  totalCount: Int!
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
  nextOffset: Int
  previousOffset: Int
}

input CreateTourInput {
  title: String!
  description: String
  shortDescription: String
  price: Float!
  currency: String
  duration: Int!
  durationType: String
  location: String!
  coordinates: CoordinatesInput
  category: String!
  difficulty: String
  highlights: [String!]
  inclusions: [String!]
  maxParticipants: Int
  minParticipants: Int
  imageUrl: String
  gallery: [String!]
  tags: [String!]
  isActive: Boolean
  isFeatured: Boolean
}

input UpdateTourInput {
  title: String
  description: String
  shortDescription: String
  price: Float
  currency: String
  duration: Int
  durationType: String
  location: String
  coordinates: CoordinatesInput
  category: String
  difficulty: String
  highlights: [String!]
  inclusions: [String!]
  maxParticipants: Int
  minParticipants: Int
  imageUrl: String
  gallery: [String!]
  tags: [String!]
  isActive: Boolean
  isFeatured: Boolean
}

input CreatePlaceInput {
  name: String!
  location: String!
  description: String!
  type: String!
  coordinates: CoordinatesInput!
  distance: Float
  tips: [String!]
  phone: String
  website: String
  hours: String
  price: Int
  locationId: ID
  imageUrl: String
}

input UpdatePlaceInput {
  name: String
  location: String
  description: String
  type: String
  coordinates: CoordinatesInput
  distance: Float
  tips: [String!]
  phone: String
  website: String
  hours: String
  price: Int
  locationId: ID
  imageUrl: String
  isOpen: Boolean
}

input CreateLocationInput {
  name: String!
  country: String!
  description: String
  coordinates: CoordinatesInput!
  popularActivities: [String!]
  averageCost: Float
  bestTimeToVisit: String
  population: String
}

input UpdateLocationInput {
  name: String
  country: String
  description: String
  coordinates: CoordinatesInput
  popularActivities: [String!]
  averageCost: Float
  bestTimeToVisit: String
  population: String
}

input BookTourInput {
  tourId: ID!
  participants: Int!
  selectedDate: String!
  fullName: String!
  email: String!
  phone: String
  specialRequests: String
}

input CreatePostInput {
  content: String
  attachments: [String!]
  type: String
  relatedId: ID
}

input UpdateUserInput {
  name: String
  username: String
  email: String
  phone: String
  avatarBase64: String
  avatarMimeType: String
}

input CoordinatesInput {
  latitude: Float!
  longitude: Float!
}
